<!DOCTYPE html>

<!-- =====================================================================================
* PROJECT: Resume Pre-Report Template
* PLATFORM: MAE (McBile AI-Engine)
* AGENT / Protocol: AHRA (Autonomous Resume Hiring Analyst)
* DESCRIPTION: Production-ready template for candidate assessment reports. (Showcase Mode)
====================================================================================== -->

<!-- =====================================================================================
* CHANGELOG v3.0 (29.08.2025)
* --------------------------------------------------------------------------------------
* UI/UX REFACTORING:
*
* JS LOGIC & STABILITY:
* 
* AI PROTOCOL & INTEGRATION:
*  
====================================================================================== -->

<html lang="ru" data-theme="dark">
<head>
<!-- ==== SECTION: HEAD ==== -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV-Report [YY.MM.DD Position. Candidate Name]</title>

<!-- ==== PART 1: AI PROTOCOL ==== -->
<!--
#######################################################
#
#  INTERNAL PROTOCOL & AI INSTRUCTIONS (MAE ARHA) 
#
#######################################################


======================================================
ВНИМАНИЕ: ДЕМОНСТРАЦИОННЫЙ РЕЖИМ
------------------------------------------------------
Этот файл содержит ПРИМЕРЫ ДАННЫХ для демонстрации в блоке
<script id="candidate-data">.
Весь контент в этом блоке (оценки, компетенции, веса) является
иллюстрацией и НЕ является истиной.
Твоя задача — ПОЛНОСТЬЮ ЗАМЕНИТЬ объект "[Название Позиции]"
в JSON на данные, полученные в результате твоего анализа.
======================================================


======================================================
СТРУКТУРА ПРОТОКОЛА MAE ARHA
------------------------------------------------------
1. Инициализация протокола
2. Глобальные ограничения и workflow
3. Роль: DTEX
4. Роль: ARHA
5. Блок кандидата (`candidate info`)
6. Сводка и вердикт (`overview`)
7. Карты компетенций (`competency cards`)
8. Предварительный грейд (`assessment`)
9. Скоринг и верификация (`scoring`)
10. Финальная аналитика (`final assessment`)
11. Риски и точки проверки (`doubts`)
12. План интервью (`interview plan`)
13. Варианты сценариев (`variations`)
14. Тестовое задание (`test assignment`)
15. Вспомогательные правила и fallback (`global utilities`)
======================================================


======================================================
1. ИНИЦИАЛИЗАЦИЯ ПРОТОКОЛА
------------------------------------------------------
Это файл-шаблон для инициализации ролей. После получения этого документа немедленно и полностью перейди к указанной ниже модели работы.
Не пересказывай и не суммируй — действуй строго по протоколу.
Твой первый ответ после загрузки этого файла должен быть подтверждением активации и запросом на запуск анализа.
======================================================


======================================================
2. ГЛОБАЛЬНЫЕ ОГРАНИЧЕНИЯ И WORKFLOW
------------------------------------------------------
1) **Шаблон (`.html` файл) является ИСТИНОЙ по дизайну и структуре. HTML/CSS/JS неизменяемы, если оператор не дал прямого разрешения на их модификацию.**
2) Оператор — всегда человек.
3) Финальный результат — полностью заполненный HTML-файл (production-ready).
4) Языковой контекст: Русский. Ключевые сущности (технологии) — на языке оригинала.
5) WORKFLOW: ANALYSIS -> REPORT -> PLAN -> AWAITING WRITTEN APPROVAL -> IMPLEMENTATION -> QA -> REPORT, IF NOT PRODUCTION READY  -> PLAN -> AWAITING WRITTEN APPROVAL -> FINAL RESULT.
======================================================


======================================================
3. РОЛЬ: DTEX (DATA-EXTRACT)
------------------------------------------------------
Назначение: извлечь и нормализовать входные данные для последующего заполнения шаблона.
Вход: Резюме кандидата (обязательно), Описание вакансии/JD (опционально).
Задачи:
1) Считать и структурировать: пол (для `data-gender`), Имя, Фамилию, возраст и местоположение, целевую должность (`[data-element="position-title"]`), опыт (компании/роли/даты), hard/tech/soft навыки, образование и сертификаты.
2) Обнаружить пробелы/несоответствия: перекрытия дат, «дыры» в опыте, противоречия в должностях/описаниях.
3) Сформировать структурированный объект данных + список вопросов для верификации.
Выход: Готовая структура данных → передать в режим ARHA.
======================================================


======================================================
4. РОЛЬ: ARHA (Autonomous Resume Hiring Analyst)
------------------------------------------------------
Назначение: провести аналитику по данным кандидата и **заполнить контент** существующего HTML-шаблона, не изменяя его структуру.
JD необязателен: если дан — оценка под JD, если нет — под iGaming-бенчмарки.
======================================================


======================================================
5. ПРАВИЛА ЗАПОЛНЕНИЯ: БЛОК КАНДИДАТА (`candidate info`)
   [data-section="candidate"]
------------------------------------------------------
1) Установить атрибут `data-gender`: "male", "female" или "neutral" для элемента `[data-element="candidate-header"]`.
2) Заполнить Имя кандидата в `[data-element="candidate-firstname"]`. Если не указано, использовать плейсхолдер "[N/A]".
3) Заполнить Фамилию кандидата в `[data-element="candidate-lastname"]`. Если не указано, использовать плейсхолдер "[N/A]".
4) Заполнить возраст кандидата в `[data-element="candidate-age"]`. Если не указан, использовать плейсхолдер "[N/A]".
5) Заполнить страну/город проживания в `[data-element="candidate-location"]`.
======================================================


======================================================
6. ПРАВИЛА ЗАПОЛНЕНИЯ: СВОДКА И ВЕРДИКТ (`overview`)
   [data-section="summary"]
------------------------------------------------------
1. **Текстовое обоснование (`[data-block="justification"]`):** Сформировать комплексный вывод, ОБЯЗАТЕЛЬНО включающий анализ следующих пунктов:
1) Ключевых сильных и слабых сторон кандидата.
2) Динамики карьерного роста (четкий рост, стагнация, частые смены).
3) Соответствия технического стека требованиям вакансии (если есть JD).
4) Качества оформления CV (структура, грамотность, наличие измеримых KPI).
5) **Обоснования Уверенности в анализе (Confidence Score):** Это критически важный пункт. Объяснить, почему присвоен уровень High/Medium/Low, ссылаясь на наличие или отсутствие измеримых результатов в резюме (KPI, %, цифры).
* **Уверенность в анализе (Confidence Score):**
* **high:** Резюме содержит измеримые результаты. Анализ надежен.
* **medium:** Резюме содержит качественные, но абстрактные описания. Анализ требует верификации.
* **low:** Резюме крайне расплывчатое или неполное. Анализ является предположением.
** ВАЖНО: 
1) Значение уверенности (High, Medium, Low) и соответствующий класс (`color-badge-bg-success`, `color-badge-bg-average`, `color-badge-bg-weak`) должны быть переданы в JS для отображения в сайдбаре (`[data-element="confidence-value"]`). 
2) При обнаружении в резюме мультизанятости (пересечения периодов работы в разных компаниях), Уверенность в анализе (`Confidence Score`) **не может быть установлена выше `medium`** (`color-badge-bg-average`).
3) При значении уверенности `low` ни одна компетенция **не может быть оценена выше `medium`** (`color-badge-bg-average`).

2. **Ключевые плюсы (`[data-block="pros"]`):** Сформулировать минимум 2-3 наиболее сильных, релевантных преимущества кандидата с прямыми примерами или цифрами из резюме. Пример: "Глубокий опыт в разработке платежных шлюзов (5+ лет в FinTech), подтвержденный проектом X".
3. **Основные риски (`[data-block="risks"]`):** Сформулировать минимум 2-3 главных риска или вопроса, требующих верификации на интервью. Пример: "Опыт с Kubernetes упомянут, но не детализирован; необходимо проверить глубину практических навыков".
======================================================


======================================================
7. ПРАВИЛА ЗАПОЛНЕНИЯ: КАРТЫ КОМПЕТЕНЦИЙ (`competency cards`)
------------------------------------------------------
Этот блок управляет оценкой и взвешиванием всех компетенций. Процесс состоит из 3 шагов: определение ценности (Принципы), расчет веса (Алгоритм) и выставление оценки (Интерпретация).

1. **Базовые принципы оценки (Что оценивать):**
* **Принципы iGaming-бенчмарка:** Это основа для определения того, ЧТО является ценным для роли в iGaming.
1) Доменная экспертиза (платежи, бонусы, KYC/AML, антифрод)
2) Инженерная строгость (архитектура, CI/CD, автоматизация)
3) Бизнес-контекст (LTV, churn, 24/7-доступность)
4) Глубина > широта (фокус минимум на 1–2 ключевых областях)
5) Soft skills и самоорганизация (удалёнка, коммуникация)
6) Цифровая культура и инновации (AI/ML)
7) Ориентация на результат/KPI
8) Командная работа
9) Консистентность резюме

2. **Динамическое распределение весов (Как взвешивать):**
* **АЛГОРИТМ:**
1) **База:** Использовать 9 Принципов iGaming как матрицу важности.
2) **Множители роли:** Определить архетип роли кандидата (см. "Архетипы" ниже) и применить соответствующие веса к каждому из 9 принципов. Если роль гибридная, веса можно усреднять.
3) **Нормализация принципов:** Убедиться, что сумма весов всех 9 принципов равна 100%.
4) **Маппинг на секции:** Распределить веса принципов по 4 секциям (hard-skills, tech-stack, soft-skills, formal). Например, "Бизнес-контекст" и "Ориентация на результат" в основном влияют на вес секции `hard-skills`. "Командная работа" и "Soft skills" - на `soft-skills`. Сумма весов секций должна быть 100%. Записать вес в `.category-weight`.
5) **Декомпозиция на пункты:** Внутри каждой секции распределить вес на 3-5 конкретных компетенций (пунктов). Сумма весов пунктов (`.item-weight`) внутри одной секции должна быть 100%.

* **Распределение Весов по 9 Архетипам (Фокусная Модель):**
#### Архетип 1: «Инженер-разработчик» (The Core Engineer)
**Ценный конечный продукт:** Создание и поддержка работающего, стабильного и производительного программного продукта и IT-инфраструктуры.
**Профессии:** Back-end / Front-end / Full-stack Developer, DevOps Engineer, Data Engineer, Innovation Developer.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Инженерная строгость** | **35%** | Качество кода, архитектуры и процессов — основа роли. |
| **Глубина > широта** | **30%** | Глубокое знание основного стека технологий — ключ к эффективности. |
| **Цифровая культура** | **20%** | Владение конкретными языками, фреймворками и инструментами. |
| Командная работа | 10% | Код-ревью, git-flow, взаимодействие в команде. |
| Бизнес-контекст | 5% | Понимание "что" и "зачем" делается. |
---
#### Архетип 2: «Архитектор Систем» (The System Architect)
**Ценный конечный продукт:** Четко спроектированная и задокументированная архитектура IT-системы, которая является мостом между бизнес-требованиями и технической реализацией.
**Профессии:** System Analyst / Architect, IT Security Specialist.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Инженерная строгость** | **30%** | Проектирование масштабируемых, надежных и безопасных систем. |
| **Бизнес-контекст** | **25%** | Способность преобразовывать бизнес-нужды в технические решения. |
| **Командная работа** | **20%** | **Ключевой навык синхронизации** бизнеса, разработки и других стейкхолдеров. |
| Soft skills | 15% | Коммуникация, защита своих решений, умение объяснять сложное. |
| Знание языков | 10% | Общение с международными командами и вендорами. |
---
#### Архетип 3: «Аналитик Данных» (The Data Analyst)
**Ценный конечный продукт:** Преобразование сырых данных в ясные, практически применимые выводы (инсайты), которые лежат в основе бизнес-решений.
**Профессии:** Data / BI / Product / Marketing Analyst, Business Process Analyst, Anti-Fraud & Data Analyst, Payment Analyst.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Бизнес-контекст** | **35%** | **Главное — не просто считать, а находить бизнес-инсайты.** |
| **Доменная экспертиза** | **30%** | Понимание метрик, специфики iGaming, поведения пользователей. |
| **Цифровая культура** | **20%** | Владение SQL, BI, Python/R — основной рабочий инструмент. |
| Soft skills | 10% | Визуализация данных и презентация своих выводов. |
| Консистентность резюме | 5% | Ясность мышления, отраженная в документе. |
---
#### Архетип 4: «Продуктовый Оркестратор» (The Product Orchestrator)
**Ценный конечный продукт:** Конкурентоспособный и прибыльный продукт, развивающийся в соответствии с видением, потребностями рынка и целями бизнеса.
**Профессии:** Product Manager, Game Manager, Bonus Manager.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Бизнес-контекст** | **35%** | Видение продукта, понимание рынка, конкурентов и пользователей. |
| **Командная работа** | **25%** | **Синхронизация всех команд — суть роли.** Влияние без полномочий. |
| **Ориентация на результат** | **20%** | Ответственность за рост продуктовых метрик. |
| Доменная экспертиза | 10% | Глубокое знание продуктовой области. |
| Знание языков | 10% | Ключевой инструмент для коммуникации в международной команде. |
---
#### Архетип 5: «Создатель Опыта» (The Experience Creator)
**Ценный конечный продукт:** Создание интуитивно понятных, удобных и эстетически привлекательных пользовательских интерфейсов, текстов и визуалов.
**Профессии:** UX/UI Designer, Graphic / Motion / Web Designer, Copywriter / Editor.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Доменная экспертиза** | **40%** | Знание принципов юзабилити, композиции, типографики, редактуры. |
| **Бизнес-контекст** | **25%** | Создание дизайна/текста, который решает конкретные бизнес-задачи. |
| Soft skills | 15% | Эмпатия к пользователю, умение воспринимать и давать критику. |
| Цифровая культура | 10% | Владение Figma, Adobe Creative Suite и другими инструментами. |
| Командная работа | 10% | Тесное взаимодействие с продуктом и разработкой. |
---
#### Архетип 6: «Драйвер Роста» (The Growth Driver)
**Ценный конечный продукт:** Прибыльный и растущий поток клиентов, сгенерированный через эффективное управление маркетинговыми, партнерскими и продающими активностями.
**Профессии:** Marketing Specialist, PPC/Media Buyer, SEO Specialist, Affiliate Manager, SMM Manager, Business Development Manager, CRM Manager, Sales & Reactivation Manager.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Ориентация на результат** | **35%** | **Главное — достижение измеримых KPI (CPA, FTD, ROI).** |
| **Доменная экспертиза** | **25%** | Глубокое знание каналов привлечения (Affiliates, SEO, PPC и т.д.). |
| Soft skills | 20% | Навыки переговоров, продаж, проактивность, драйв. |
| **Знание языков** | **15%** | **Основа для работы с международными партнерами и рынками.** |
| Бизнес-контекст | 5% | Понимание юнит-экономики и продукта. |
---
#### Архетип 7: «Хранитель» (The Guardian)
**Ценный конечный продукт:** Обеспечение правовой, финансовой и операционной безопасности компании; минимизация рисков.
**Профессии:** Legal Counsel, Finance/Treasury Specialist, PSP Manager, KYC & Finance Manager, Internal Security Specialist, Betting Specialist/Risk Manager.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Доменная экспертиза** | **45%** | **Основа роли — глубокие экспертные знания в праве, финансах, рисках.** |
| **Консистентность резюме** | **20%** | **Прямое доказательство скрупулезности и внимания к деталям.** |
| Soft skills | 15% | Ответственность, честность, принципиальность, внимание к деталям. |
| Бизнес-контекст | 10% | Применение экспертизы для защиты и роста бизнеса. |
| Знание языков | 10% | Для работы с международным правом, PSP, документацией. |
---
#### Архетип 8: «Чемпион Людей» (The People Champion)
**Ценный конечный продукт:** Высокий уровень удовлетворенности и лояльности внешних клиентов и внутренних сотрудников.
**Профессии:** Recruiter/Talent Acquisition, HR Business Partner/People Partner, Support Agent, VIP Account Manager, Event Manager.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Soft skills** | **45%** | **Эмпатия, коммуникация, умение решать проблемы людей, строить отношения.** |
| **Доменная экспертиза** | **25%** | Понимание потребностей клиентов/сотрудников, HR-процессов. |
| **Знание языков** | **20%** | **Ключевой инструмент для работы с международными командами и клиентами.** |
| Бизнес-контекст | 10% | Понимание влияния сервиса и HR на общие цели компании. |
---
#### Архетип 9: «Страж Качества» (The Quality Gatekeeper)
**Ценный конечный продукт:** Гарантированное соответствие продукта или процесса установленным стандартам качества.
**Профессии:** QA Specialist (Manual), Quality Control Manager, CMS Specialist, Sys-Admin.
| Принцип | Вес (%) | Обоснование |
| :--- | :---: | :--- |
| **Доменная экспертиза** | **40%** | Знание методологий тестирования, стандартов, процессов поддержки. |
| **Консистентность резюме** | **25%** | **Внимание к деталям в резюме, баг-репортах — это основной рабочий навык.** |
| Soft skills | 20% | Усидчивость, дотошность, умение четко описывать проблемы. |
| Инженерная строгость | 10% | Понимание процессов разработки/поддержки. |
| Командная работа | 5% | Взаимодействие с разработкой и другими командами.

3. **Интерпретация оценок (Как ставить балл):**
* `color-badge-bg-success` = **значение 0.99 (99%)**: Навык подтвержден убедительно (конкретные проекты, измеримые результаты).
* `color-badge-bg-average` = **значение 0.6 (60%)**: Навык упомянут, но без деталей; опыт релевантен, но абстрактен. Требует верификации.
* `color-badge-bg-weak` = **значение 0.1 (10%)**: Навык отсутствует, устарел или упомянут формально без подтверждения.
======================================================


======================================================
8. ПРАВИЛА ЗАПОЛНЕНИЯ: ПРЕДВАРИТЕЛЬНЫЙ ГРЕЙД (`assessment`)
   [data-section="assessment-summary"]
------------------------------------------------------
* **Матрица грейдов:**
* **Junior/Junior+:** Требует инструкций для выполнения задач/ Предсказуем.
* **Middle/Middle+:** Самостоятелен в стандартных задачах/ Предсказуем.
* **Senior/Lead:** Владеет доменом, наставляет коллег, предлагает решения/ Отвечает за тактический результат команды.
* **Head/C-Level:** Отвечает за стратегию и P&L/ Бизнес-результаты направления или компании.
* **Обоснование:** Дать четкое обоснование присвоенного грейда, ссылаясь на опыт, автономность и сложность решаемых задач, описанных в резюме.
* **НОВОЕ ПРАВИЛО:** **Формат грейда:** Поле должно содержать строго один уровень. Например, `Senior` или `Lead`, но не `Senior/Lead`.
======================================================


======================================================
9. ПРАВИЛА ЗАПОЛНЕНИЯ: СКОРИНГ И ВЕРИФИКАЦИЯ (`scoring`)
   [data-section="assessment-summary"]
------------------------------------------------------
* **Scoring:** Скрипт автоматически рассчитает текущую оценку (`[data-element="score-value"]`) на основе выставленных оценок компетенций.
* **Verification Points:**
* **Заполнение списка:** Внести в JSON-данные все пункты со статусом `color-badge-bg-average` и `color-badge-bg-weak`, которые являются **"Верифицируемыми Пунктами"**.
* **Расчет потенциала:** Скрипт автоматически рассчитает и отобразит в списке `[data-element="verification-list"]` потенциальный прирост (%) для каждого пункта.
======================================================


======================================================
10. ПРАВИЛА ЗАПОЛНЕНИЯ: ФИНАЛЬНАЯ АНАЛИТИКА (`final assessment`)
    [data-section="final-assessment"]
------------------------------------------------------
* **Ценность:** Сформулировать краткую оценку: "[Имя Фамилия] представляет [сильную/умеренную/недостаточную] ценность для команды".
* **Главный актив:** Определить одно, самое важное преимущество кандидата.
* **Ключевое условие найма:** Сформулировать главный фактор, от которого зависит решение (например, "успешная верификация опыта с X").
======================================================


======================================================
11. ПРАВИЛА ЗАПОЛНЕНИЯ: РИСКИ И ТОЧКИ ПРОВЕРКИ (`doubts`)
    [data-section="doubts"]
------------------------------------------------------
* **Классификация Рисков (КЛЮЧЕВОЕ ПРАВИЛО):**
* **Верифицируемый Пункт (Динамический Риск):** Неясное утверждение, которое можно проверить. Успешная проверка повышает оценку. **Цель вопроса:** "Докажи это". **Пример:** "Опыт с Kafka описан абстрактно".
* **Пункт для Исследования (Статический Факт):** Неизменяемый факт биографии (пробел в опыте, смена сферы). Обсуждение не меняет оценку, но раскрывает soft skills. **Цель вопроса:** "Объясни это". **Пример:** "Частая смена работы в 2022-2023 гг.".
* **Обработка Мультизанятости:**
* **Риск:** "Пересечение дат работы в нескольких проектах".
* **Вопрос:** "Как вы распределяли время и обязанности между проектами? Каковы были приоритеты и SLA?".
* **Классифицировать** как динамический риск, если формат неясен.
======================================================


======================================================
12. ПРАВИЛА ЗАПОЛНЕНИЯ: ПЛАН ИНТЕРВЬЮ (`interview plan`)
    [data-section="interview-plan"]
------------------------------------------------------
* Сформировать детализированный, трехэтапный план с конкретными примерами вопросов:
1. **Verification (X мин):** Сфокусироваться на снятии рисков. **Пример вопроса:** "Вы указали опыт с [ключевая технология из резюме]. Опишите кейс, где вы решали проблему с [релевантная бизнес-задача]".
2. **Deep Dive (Y мин):** Глубоко проверить самую сильную компетенцию. **Пример вопроса:** "Ваша сильная сторона - [сильнейшая компетенция]. Как бы вы спроектировали [сложная система/процесс] для [релевантная бизнес-цель]?".
3. **Behavioral (Z мин):** Задать вопросы на мотивацию и soft skills. **Пример вопроса:** "Я вижу, что вы перешли из [предыдущая сфера] в [текущая сфера]. Что послужило основной мотивацией и с какими трудностями вы столкнулись?".
======================================================


======================================================
13. ПРАВИЛА ЗАПОЛНЕНИЯ: ВАРИАНТЫ СЦЕНАРИЕВ (`variations`)
    [data-section="variations"]
------------------------------------------------------
* Заполнить 3 сценария (Успех, Частичное подтверждение, Провал) с четкими рекомендациями по дальнейшим действиям.
======================================================


======================================================
14. ПРАВИЛА ЗАПОЛНЕНИЯ: ТЕСТОВОЕ ЗАДАНИЕ (`test assignment`)
    [data-section="test-assignment"]
------------------------------------------------------
1. **Принципы создания ТЗ:** Релевантность (задача близка к реальной), Ограничение по времени (1-2 часа), Однозначность (четкие требования), Оцениваемость (измеримые метрики успеха).
2. **Бриф Задания (`pre#test-assignment-md`):** Сформулировать контекст, требования и метрики.
3. **Критерии Оценки (`pre#evaluation-form-md`):** Заполнить таблицу критериями, например: Качество кода, Соответствие требованиям, Подход к решению.
======================================================


======================================================
15. ВСПОМОГАТЕЛЬНЫЕ ПРАВИЛА И FALLBACK (`global utilities`)
------------------------------------------------------
1. **Идентичность данных:** Все текстовые выводы, отражающие числовые оценки (например, вердикт), ДОЛЖНЫ быть сгенерированы на основе результатов расчетов скрипта.
2. **Fallback-логика:**
* Нет JD? Используй отраслевые бенчмарки iGaming.
* Нет множителей роли? Генерируй их по роли из `[data-element="position-title"]` и содержимого резюме.
3. **Final Check:** Перед выдачей результата убедиться, что все текстовые поля и атрибуты заполнены, классы `color-*` расставлены, суммы весов корректны, а структура HTML/CSS/JS не нарушена.

==== END PART 1 ==== -->


<!-- ==== PART 2: STYLES ==== 
==== SECTION: STYLES ==== 
==== PART 2.1: CORE & THEMES ==== -->

<style>
:root 
{
--color-bg: #FFFFFF;
--color-bg-surface: #F2F2F7;
--color-title: #000000;
--color-text-main: #1C1C1E;
--color-text-muted: #6E6E73;
--color-accent: #007AFF;
--color-accent-a: rgba(0,122,255,0.15);
--color-badge-text: #111;
--color-badge-bg-danger: #FF3B30;
--color-badge-bg-weak: #FF9F94;
--color-badge-bg-average: #FFCC00;
--color-badge-bg-success: #34C759;
--color-badge-bg-strong: #30D158;
--color-border: #D1D1D6;
--border-width: 1px;
}

[data-theme="dark"] 
{
--color-bg: #202124;
--color-bg-surface: #2D2E30;
--color-title: #E8EAED;
--color-text-main: #E0E0E0;
--color-text-muted: #BDC1C6;
--color-accent: #8AB4F8;
--color-accent-a: rgba(138,180,248,0.16);
--color-badge-text: #202124;
--color-badge-bg-danger: #FF4444;
--color-badge-bg-weak: #F28B82;
--color-badge-bg-average: #FDD663;
--color-badge-bg-success: #188038;
--color-badge-bg-strong: #34A853;
--color-border: #3C4043;
--border-width: 1px;
}


<!-- ==== "dark 2" 
 --color-bg: #101010;
--color-bg-surface: #202020;
--color-title: #A1C9FF;
--color-accent: #A6C9FF;
--color-accent-a: rgba(165, 201, 255, 0.10);
--color-badge-text: #202020;
--color-text-main: #F4E8D0;
--color-text-muted: #E0E0E0; 
--color-border: #404040;
--color-badge-bg-danger: #FF4444;
--color-badge-bg-weak: #FF9999;
--color-badge-bg-average: #F9F452;
--color-badge-bg-success: #50D890;
--color-badge-bg-strong: #79D79A;
--border-width: 1px;     
 
==== -->


/* ==== END PART 2.1 ==== */

/* ==== PART 2.2: BASE & LAYOUT ==== */
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: var(--color-bg); color: var(--color-text-main); font-size: 16px; line-height: 1.5; }
.container { width: 95%; max-width: 1400px; margin: 0 auto; padding: 15px 0; }
.dashboard-layout { display: grid; grid-template-columns: 320px 1fr; gap: 30px; align-items: flex-start; }
.dashboard-sidebar { position: sticky; top: 90px; display: flex; flex-direction: column; gap: 20px; }
.dashboard-content { display: flex; flex-direction: column; gap: 20px; }
/* ==== END PART 2.2 ==== */

/* ==== PART 2.3: HEADER & CONTROLS ==== */
#controls-section { position: sticky; top: 0; z-index: 100; background: var(--color-bg); padding: 10px 0; border-bottom: var(--border-width) solid var(--color-border); }
#controls-section .container { padding: 0; }
.controls-panel { display: flex; gap: 0.75em; align-items: center; }
#header-title { font-size: 1.35em; font-weight: 600; color: var(--color-title); margin-right: auto; padding-right: 1em; white-space: nowrap; }
.control-btn { position: relative; background-color: var(--color-bg-surface); border: var(--border-width) solid var(--color-border); padding: 0; border-radius: 8px; color: var(--color-text-main); cursor: pointer; display: flex; align-items: center; justify-content: center; height: 44px; width: 44px; flex-shrink: 0; transition: all 0.2s ease; }
.control-btn:hover { border-color: var(--color-title); color: var(--color-badge-bg-average); }
.control-btn svg { width: 22px; height: 22px; pointer-events: none; }
#theme-switcher .icon-sun { display: block; } #theme-switcher .icon-moon { display: none; }
[data-theme="light"] #theme-switcher .icon-sun { display: none; } [data-theme="light"] #theme-switcher .icon-moon { display: block; }
.dropdown-wrapper { position: relative; }
.dropdown-menu { display: none; position: absolute; top: 110%; right: 0; background-color: var(--color-bg-surface); border: var(--border-width) solid var(--color-border); border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 8px; z-index: 100; min-width: 220px; }
.dropdown-menu.is-open { display: block; }
.dropdown-menu a { display: block; padding: 10px 15px; text-decoration: none; color: var(--color-text-main); border-radius: 4px; }
.dropdown-menu a:hover { background-color: var(--color-bg); }
#email-dropdown .action-item { padding: 10px; }
#email-dropdown .email-input { width: 100%; padding: 8px 12px; border-radius: 6px; border: var(--border-width) solid var(--color-border); background-color: var(--color-bg); color: var(--color-text-main); }
#email-dropdown .btn-action { display: block; width: 100%; background-color: var(--color-accent); color: var(--color-badge-text); padding: 10px; border: none; border-radius: 6px; font-weight: 500; cursor: pointer; text-align: center; margin-top: 10px; text-decoration: none; }
/* ==== END PART 2.3 ==== */

/* ==== PART 2.4: CARDS (GENERAL) ==== */
.card { background-color: var(--color-bg-surface); border-radius: 12px; border: var(--border-width) solid var(--color-border); overflow: hidden; }
.card-header { display: flex; justify-content: space-between; align-items: center; gap: 15px; padding: 10px 15px; border-bottom: var(--border-width) solid var(--color-border); }
.card-header h2 { font-size: 1.2em; font-weight: 600; margin: 0; display: flex; align-items: center; gap: 0.75em; color: var(--color-accent); flex-grow: 1; }
.card-header h2 svg { width: 1em; height: 1em; flex-shrink: 0; }
.card-header .category-weight { font-size: 0.9em; font-weight: 500; color: var(--color-text-main); }
.card-content { padding: 15px; background-color: var(--color-bg-surface); }
/* ==== END PART 2.4 ==== */

/* ==== PART 2.5: SIDEBAR COMPONENTS ==== */
.sidebar-block { padding: 15px; }
[data-element="candidate-header"] { text-align: left; }
[data-element="candidate-name"] { font-size: 1.2em; margin-bottom: 8px; color: var(--color-accent); }
.candidate-meta-group { display: flex; align-items: center; gap: 15px; color: var(--color-text-main); }
[data-section="position"] { text-align: center; }
[data-element="position-title"] { display: inline-block; background-color: var(--color-bg); padding: 4px 10px; border-radius: 6px; font-weight: 500; color: var(--color-text-main); font-size: 1.3em; }
.score-display { display: flex; justify-content: space-between; align-items: center; padding: 15px 0 0 0; margin-top:15px; border-top: 1px solid var(--color-border); }
[data-section="assessment-summary"] .score-display:first-child { padding-top: 0; margin-top:0; border-top: none; }
[data-section="assessment-summary"] h4 { padding-top: 15px; margin-top:15px; border-top: 1px solid var(--color-border); color: var(--color-accent-a); }
.score-label, [data-section="assessment-summary"] h4 { font-size: 1.1em; font-weight: 500; line-height: 1.3; }
.score-value { font-size: 1.1em; font-weight: bold; padding: 4px 10px; border-radius: 6px; color: var(--color-badge-text); min-width: 120px; text-align: center; }
.score-value.color-badge-bg-weak { background-color: var(--color-badge-bg-weak); }
.score-value.color-badge-bg-average { background-color: var(--color-badge-bg-average); }
.score-value.color-badge-bg-success { background-color: var(--color-badge-bg-success); }
.score-value.color-badge-bg-strong { background-color: var(--color-badge-bg-strong); }
[data-element="score-value"] { min-width: 150px; }
[data-section="assessment-summary"] h4 { margin-bottom: 5px; text-align: left; }
[data-element="verification-list"] { list-style: none; font-size: 1em; display: flex; flex-direction: column; gap: 8px; background-color: var(--color-bg); padding: 10px; border-radius: 8px; border: var(--border-width) solid var(--color-border); margin-top:0; }
[data-element="verification-list"] li { display: flex; justify-content: space-between; }
[data-element="verification-list"] .risk-value { font-weight: 600; color: var(--color-badge-bg-strong); }
/* ==== END PART 2.5 ==== */

/* ==== PART 2.6: MAIN CONTENT COMPONENTS ==== */
.content-list { list-style: none; padding: 0; display: flex; flex-direction: column; gap: 15px; }
.content-block { background-color: var(--color-bg); border: var(--border-width) solid var(--color-border); border-radius: 8px; padding: 15px; }
.grid-2-col { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
[data-block="justification"] h4 { margin-top: 0; margin-bottom: 10px; font-size: 1.1em; transition: color 0.3s; font-weight: 600; line-height: 1.5; }
.summary-grid { margin-top: 10px; }
.score-badge { display: inline-block; padding: 2px 8px; font-size: 0.85em; font-weight: 600; border-radius: 6px; color: var(--color-badge-text); text-align: center; vertical-align: middle; line-height: 1.5; }
[data-element="competency-item"] { padding: 10px 20px; }
.competency-header { margin-bottom: 12px; }
.progress-display { display: flex; align-items: center; gap: 15px; margin-bottom: 8px; }
.progress-bar-wrapper { flex-grow: 1; flex-basis: 70%; height: 6px; background-color: var(--color-border); border-radius: 3px; overflow: hidden; }
.progress-bar { height: 100%; border-radius: 3px; }
.item-weight { font-size: 0.9em; font-weight: 500; color: var(--color-text-main); flex-shrink: 0; }
[data-element="competency-item"].color-badge-bg-success .progress-bar { background-color: var(--color-badge-bg-success); width: 95%; } [data-element="competency-item"].color-badge-bg-average .progress-bar { background-color: var(--color-badge-bg-average); width: 60%; } [data-element="competency-item"].color-badge-bg-weak .progress-bar { background-color: var(--color-badge-bg-weak); width: 10%; }
[data-block="justification"], [data-block="pros"], [data-block="risks"], [data-block*="step"], [data-block*="variation"], [data-block*="risk"], [data-block*="assessment"] { border-left-width: 4px; border-style: solid;}
[data-block="justification"], [data-block="assessment-asset"], [data-block="assessment-condition"], [data-block*="step"] { border-left-color: var(--color-text-muted); }
[data-block="pros"] { border-left-color: var(--color-badge-bg-success); } [data-block="risks"] { border-left-color: var(--color-badge-bg-danger); }
[data-block="variation-success"], [data-block="assessment-value"].color-badge-bg-success { border-left-color: var(--color-badge-bg-success); }
[data-block="variation-average"], [data-block="assessment-value"].color-badge-bg-average, [data-block="risk-dynamic"] { border-left-color: var(--color-badge-bg-average); }
[data-block="variation-danger"], [data-block="assessment-value"].color-badge-bg-weak { border-left-color: var(--color-badge-bg-danger); }
[data-block="risk-static"] { border-left-color: var(--color-text-muted); }
.text-color-badge-bg-average { color: var(--color-badge-bg-average); }
.font-weight-600 { font-weight: 600; }
.text-accent-secondary { color: var(--color-text-muted); margin-bottom: 6px; }
.border-left-success { border-left-color: var(--color-badge-bg-success) !important; }
.border-left-danger { border-left-color: var(--color-badge-bg-danger) !important; }
.task-block-wrapper { display: grid; grid-template-columns: 1fr; gap: 20px; }
.task-header { display: flex; align-items: center; gap:15px; margin-bottom: 10px; }
.task-header h4 { margin: 0; flex-grow: 1; }
pre, .notes-textarea { background-color: var(--color-bg); padding: 10px; border-radius: 8px; border: var(--border-width) solid var(--color-border); white-space: pre-wrap; word-break: break-word; }
pre, .notes-textarea { font-family: 'SF Mono', 'Fira Code', monospace; }
pre#test-assignment-md, pre#evaluation-form-md { color: var(--color-text-muted); font-size: 0.85em; }
.notes-textarea { width: 100%; min-height: 150px; font-size: 0.85em; color: var(--color-text-muted); resize: vertical; }
/* ==== END PART 2.6 ==== */

/* ==== PART 2.7: UTILITIES & FOOTER ==== */
#scrollToTopBtn { position: fixed; bottom: 20px; right: 20px; z-index: 1000; opacity: 0; visibility: hidden; transform: translateY(20px); transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease; }
#scrollToTopBtn.is-visible { opacity: 1; visibility: visible; transform: translateY(0); }
footer { text-align: center; margin-top: 1rem; padding: 1rem 0; color: var(--color-text-muted); font-size: 0.9em; }
footer p { margin: 0.25rem 0; }
footer .copyright { color: var(--color-accent-a); font-weight: bold; }
/* ==== END PART 2.7 ==== */

/* ==== PART 2.8: RESPONSIVE & PRINT STYLES ==== */
@media (max-width: 1024px) {
.dashboard-layout, .grid-2-col { grid-template-columns: 1fr; }
.dashboard-sidebar { position: static; }
}
@media print {
:root {
--color-bg: #FFFFFF;
--color-bg-surface: #E7E7E9;
--color-title: #000000;
--color-text-main: #1C1C1E;
--color-text-muted: #6E6E73;
--color-accent: #007AFF;
--color-accent-a: rgba(0,122,255,0.15);
--color-badge-text: #111;
--color-badge-bg-danger: #FF3B30;
--color-badge-bg-weak: #FF9F94;
--color-badge-bg-average: #FFCC00;
--color-badge-bg-success: #34C759;
--color-badge-bg-strong: #30D158;
--color-border: #D1D1D6;
--border-width: 1px;
}

#controls-section, footer, #scrollToTopBtn { display: none !important; }
.card, .content-block { page-break-inside: avoid; } 
html { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
@page { size: A4; margin: 16mm; }
* { animation: none !important; transition: none !important; box-shadow: none !important; }
.sticky, [style*="position: sticky"] { position: static !important; }
.card, .content-block { overflow: visible !important; word-break: break-word; overflow-wrap: anywhere; }
img, svg, video, canvas { max-width: 100% !important; height: auto !important; }
}
/* ==== END PART 2.8 ==== */

/* ==== END SECTION: STYLES ==== */
</style>
<!-- ==== END PART 2 ==== -->
</head>

<body>

<!-- ==== SECTION: HEADER & CONTROLS ==== -->
<header id="controls-section">
<div class="container">
<div class="controls-panel">
<!-- Element: Title -->
<h1 id="header-title">CV Report</h1>
<!-- Element: Section Selector -->
<div class="dropdown-wrapper">
<button id="section-selector-btn" class="control-btn" title="Перейти к секции"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></button>
<div id="section-selector-dropdown" class="dropdown-menu"></div>
</div>
<!-- Element: Save to PDF -->
<button id="save-pdf-btn" class="control-btn" title="Сохранить в PDF"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg></button>
<!-- Element: Send Email -->
<div class="dropdown-wrapper">
<button id="email-btn" class="control-btn" title="Отправить Email"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></button>
<div id="email-dropdown" class="dropdown-menu">
<div class="action-item"><input type="email" id="recipient-email" class="email-input" placeholder="Email получателя"><button id="send-report-email" class="btn-action">Сформировать Email</button></div>
</div>
</div>
<!-- Element: Theme Switcher -->
<button id="theme-switcher" class="control-btn" title="Сменить тему"><svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg><svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button>
</div>
</div>
</header>
<!-- ==== END SECTION: HEADER & CONTROLS ==== -->

<!-- ==== SECTION: MAIN WRAPPER ==== -->
<main>
<div class="container">
<div class="dashboard-layout">

<!-- ==== COMPONENT: SIDEBAR ==== -->
<aside id="dashboard-sidebar" class="dashboard-sidebar">

<!-- Card: Position -->
<div data-section="position" class="card sidebar-block">
<div data-element="position-title"><span>[Название Позиции]</span></div>
</div>
<!-- End Card: Position -->

<!-- Card: Candidate Info -->
<div data-section="candidate" class="card sidebar-block">
    <div data-element="candidate-header" data-gender="neutral">
        <h2 data-element="candidate-name">
            <span data-element="candidate-firstname">[Имя]</span>
            <span data-element="candidate-lastname">[Фамилия]</span>
        </h2>
        <div class="candidate-meta-group">
            <span data-element="candidate-age">[Возраст],</span>
            <span data-element="candidate-location">[Место жительства]</span>
        </div>
    </div>
</div>
<!-- End Card: Candidate Info -->

<!-- Card: Assessment Summary -->
<div data-section="assessment-summary" class="card sidebar-block">
    <!-- Metric: Confidence -->
    <div class="score-display">
        <span class="score-label">Confidence</span>
        <span data-element="confidence-value" class="score-value"></span>
    </div>
    <!-- Metric: Pre-Grade -->
    <div class="score-display">
        <span class="score-label">Pre-Grade</span>
        <span data-element="grade-value" class="score-value"></span>
    </div>
    <!-- Metric: Score -->
    <div class="score-display">
        <span class="score-label">Score</span>
        <span data-element="score-value" class="score-value"></span>
    </div>
    <!-- Metric: Verification Points -->
    <h4 style="text-align: center;">Verification Points</h4>
    <ul data-element="verification-list"></ul>
</div>
<!-- End Card: Assessment Summary -->

</aside>
<!-- ==== END COMPONENT: SIDEBAR ==== -->

<!-- ==== COMPONENT: MAIN CONTENT ==== -->
<section class="dashboard-content">

<!-- Card: Overview -->
<div data-section="summary" class="card">
<div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg> <span>Overview</span></h2></div>
<div class="card-content">
<div data-block="justification" class="content-block">
<h4 data-element="justification-title">Детализация Оценки</h4>
<ul>
    <li>[Детальное текстовое обоснование вердикта, основанное на: ключевых сильных и слабых сторонах, динамике карьерного роста или стагнации, проценте соответствия техстека (если есть JD), общей оценке оформления CV.]</li><br>
    <li>[Детальное обоснование присвоенного грейда с отсылкой к формальной матрице, опыту кандидата и требованиям вакансии.]</li><br>
    <li>[Детальное обоснование Confidence Score со ссылкой на наличие/отсутствие KPI в резюме, его структурированность и полноту.]</li>
</ul>
</div>
<div class="grid-2-col summary-grid">
    <!-- Element: Pro Skills -->
<div data-block="pros" class="content-block">
<h4><span class="text-accent-secondary">Ключевые плюсы:</span></h4>
<ul><li>[Ключевое преимущество 1, подкрепленное фактом или цифрой из резюме.]</li><br><li>[Ключевое преимущество 2, демонстрирующее релевантный опыт.]</li></ul>
</div>
    <!-- Element: Risk Skills -->
<div data-block="risks" class="content-block">
<h4><span class="text-accent-secondary">Основные риски:</span></h4>
<ul><li>[Основной риск 1, требующий верификации, с указанием на пробел в данных.]</li><br><li>[Основной риск 2, связанный с потенциальным несоответствием технологий или методологий.]</li></ul>
</div>
</div>
</div>
</div>
<!-- End Card: Overview -->

<!-- Card: Hard Skills -->
<div id="hard-skills" data-section="hard-skills" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg> <span>Hard Skills</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Hard Skills -->

<!-- Card: Tech-Stack -->
<div id="tech-stack" data-section="tech-stack" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg> <span>Tech-Stack</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Tech-Stack -->

<!-- Card: Soft Skills -->
<div id="soft-skills" data-section="soft-skills" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg> <span>Soft Skills</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Soft Skills -->

<!-- Card: Add. Info -->
<div id="formal" data-section="formal" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="9" y1="15" x2="15" y2="15"></line></svg> <span>Add. Info</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Add. Info -->

<!-- Card: Final Assessment -->
<div id="final-assessment" data-section="final-assessment" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg> <span>Final Assessment</span></h2></div>
    <div class="card-content"><div class="content-list"><div data-block="assessment-value" class="content-block"><p><strong><span class="text-accent-secondary">Ценность:</span></strong> [Имя] представляет [сильную/умеренную/недостаточную] ценность для команды на текущем этапе.</p></div><div data-block="assessment-asset" class="content-block border-left-success"><p><strong><span class="text-accent-secondary">Главный актив:</span></strong> [Описание ключевого преимущества кандидата, например, "глубокая экспертиза в домене X" или "опыт построения Y-систем с нуля".]</p></div><div data-block="assessment-condition" class="content-block border-left-danger"><p><strong><span class="text-accent-secondary">Ключевое условие найма:</span></strong> [Формулировка главного условия, которое должно быть выполнено для принятия решения о найме, например, "успешное прохождение верификации опыта с технологией Z".]</p></div></div></div>
</div>
<!-- End Card: Final Assessment -->

<!-- Card: Risk / Verification -->
<div id="doubts" data-section="doubts" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg> <span>Risk / Verification</span></h2></div>
    <div class="card-content"><ul class="question-list content-list"><li data-block="risk-dynamic" class="content-block"><strong class="text-accent-secondary">Верифицируемый Пункт (Динамический Риск):</strong> [Неясное утверждение, которое можно проверить.]<br><em>Вопрос (Цель: "Докажи это"): [Конкретный вопрос для проверки навыка.]</em></li><li data-block="risk-static" class="content-block"><strong class="text-accent-secondary">Пункт для Исследования (Статический Факт):</strong> [Неизменяемый факт биографии, например, пробел в опыте.]<br><em>Вопрос (Цель: "Объясни это"): [Вопрос на мотивацию и софт-скиллы.]</em></li></ul></div>
</div>
<!-- End Card: Risk / Verification -->

<!-- Card: Variations -->
<div id="variations" data-section="variations" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 4H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="12" y1="9" x2="12" y2="15"></line><line x1="9" y1="12" x2="15" y2="12"></line></svg> <span>Variations</span></h2></div>
    <div class="card-content"><ul class="content-list"><li data-block="variation-success" class="content-block"><p><strong class="text-accent-secondary">Сценарий: Успех.</strong> [Описание позитивного исхода интервью, когда все риски сняты.]<br><strong class="text-accent-secondary">Решение:</strong> [Четкая рекомендация, например, "Готовить оффер."]</p></li><li data-block="variation-average" class="content-block"><p><strong class="text-accent-secondary">Сценарий: Частичное подтверждение.</strong> [Описание смешанного исхода, когда подтверждены не все компетенции.]<br><strong class="text-accent-secondary">Решение:</strong> [Альтернативная рекомендация, например, "Рассмотреть на другую роль."]</p></li><li data-block="variation-danger" class="content-block"><p><strong class="text-accent-secondary">Сценарий: Провал.</strong> [Описание негативного исхода, когда риски подтвердились.]<br><strong class="text-accent-secondary">Решение:</strong> [Четкая рекомендация, например, "Отклонить кандидатуру."]</p></li></ul></div>
</div>
<!-- End Card: Variations -->

<!-- Card: Interview Plan -->
<div id="interview-plan" data-section="interview-plan" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> <span>Interview Plan</span></h2></div>
    <div class="card-content"><ul class="plan-list content-list"><li data-block="interview-step-1" class="content-block"><strong class="text-accent-secondary">Этап 1: Verification (X мин):</strong> [Детальное описание, какие риски и как проверять, с примерами вопросов.]</li><li data-block="interview-step-2" class="content-block"><strong class="text-accent-secondary">Этап 2: Deep Dive (Y мин):</strong> [Детальное описание, в какую сильную сторону кандидата нужно "копать", с примерами глубоких вопросов.]</li><li data-block="interview-step-3" class="content-block"><strong class="text-accent-secondary">Этап 3: Behavioral (Z мин):</strong> [Детальное описание, какие поведенческие аспекты нужно проверить, с примерами вопросов.]</li></ul></div>
</div>
<!-- End Card: Interview Plan -->

<!-- Card: Test Assignment -->
<div id="test-assignment" data-section="test-assignment" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg> <span>Test Assignment</span></h2></div>
    <div class="card-content">
        <div class="task-block-wrapper grid-2-col">
            <div>
                <div class="task-header">
                    <h4>Бриф Задания</h4>
                    <button class="control-btn" id="download-task-md-btn" title="Скачать .md"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>
                </div>
                <pre id="test-assignment-md">## Задача: [Название задачи]

Контекст: [Детальное описание бизнес-контекста и проблемы, которую нужно решить.]

Требования:

[Требование 1]
[Требование 2]
[Требование 3]

Время выполнения: [Например, 1-2 часа]
Метрики успеха: [Конкретные, измеримые критерии успеха, например, "покрытие тестами >80%".]</pre>
</div>
<div>
<div class="task-header">
<h4>Критерии Оценки</h4>
<button class="control-btn" id="download-evaluation-md-btn" title="Скачать .md"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>
</div>
<pre id="evaluation-form-md">Критерий (1-5) | Комментарии
----------------|------------------------------------
[Критерий 1] | [Описание того, что проверяется.]
[Критерий 2] | [Описание того, что проверяется.]
[Критерий 3] | [Описание того, что проверяется.]</pre>
</div>
</div>
</div>
</div>
<!-- End Card: Test Assignment -->

<!-- Card: Comments -->
<div id="comments" data-section="comments" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg> <span>Notes</span></h2><button class="control-btn" id="save-comments-md-btn" title="Скачать комментарии .md"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button></div>
    <div class="card-content"><textarea id="notes-textarea" class="notes-textarea" placeholder="Поле для заметок рекрутера..."></textarea></div>
</div>
<!-- End Card: Comments -->

</section>
<!-- ==== END COMPONENT: MAIN CONTENT ==== -->

</div>
</div>
</main>
<!-- ==== END SECTION: MAIN WRAPPER ==== -->

<!-- ==== SECTION: UTILITIES ==== -->
<button id="scrollToTopBtn" class="control-btn" title="Наверх"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg></button>
<!-- ==== END SECTION: UTILITIES ==== -->

<!-- ==== SECTION: FOOTER ==== -->
<footer>
<p>Generated by MAE ARHA</p> 
<p class="copyright">© 2025 McBile AI-Engine</p>
</footer>
<!-- ==== END SECTION: FOOTER ==== -->

<!-- ==== SECTION: DATA & LOGIC ==== -->

<!-- ==== Component: Candidate Data (JSON) ==== -->
<script id="candidate-data" type="application/json">
{
  "[Название Позиции]": {
    "grade": "Junior+",
    "confidence": "Medium",
    "weights": {
      "hard-skills": 40,
      "tech-stack": 30,
      "soft-skills": 20,
      "formal": 10
    },
    "competencies": {
      "hard-skills": [
        { "name": "[Ключевая компетенция 1]", "scoreClass": "color-badge-bg-success", "weight": 50, "justification": "[Пример из резюме с измеримым результатом, подтверждающий высокий уровень владения.]" },
        { "name": "[Ключевая компетенция 2]", "scoreClass": "color-badge-bg-average", "weight": 30, "justification": "[Навык упомянут, но без конкретных примеров или KPI. Требует верификации.]" },
        { "name": "[Ключевая компетенция 3]", "scoreClass": "color-badge-bg-weak", "weight": 20, "justification": "[Навык отсутствует в резюме, но является важным для оценки по бенчмарку.]" }
      ],
      "tech-stack": [
        { "name": "[Основная технология]", "scoreClass": "color-badge-bg-success", "weight": 60, "justification": "[Подтвержденный опыт использования в нескольких проектах.]" },
        { "name": "[Вспомогательная технология]", "scoreClass": "color-badge-bg-average", "weight": 40, "justification": "[Технология упомянута в списке навыков без описания проектов.]" }
      ],
      "soft-skills": [
        { "name": "[Гибкий навык 1]", "scoreClass": "color-badge-bg-success", "weight": 80, "justification": "[Косвенное подтверждение через описание командных ролей и достижений.]" },
        { "name": "[Гибкий навык 2]", "scoreClass": "color-badge-bg-average", "weight": 20, "justification": "[Навык важен для роли, но не может быть оценен по резюме. Требует проверки на интервью.]" }
      ],
      "formal": [
        { "name": "[Формальный критерий]", "scoreClass": "color-badge-bg-success", "weight": 100, "justification": "[Соответствие подтверждено информацией в резюме (например, уровень языка, сертификат).]" }
      ]
    }
  },
  "Default": { "grade": "[...]" }
}
</script>
<!-- ==== End Component: Candidate Data (JSON) ==== -->

<!-- ==== SCRIPT: MAIN APPLICATION LOGIC ==== -->
<script>
// Encapsulate the entire application logic to avoid polluting the global namespace.
const HiringCoPilotApp = {
    // ==== 1. CONFIG & CONSTANTS ====
    config: {
        SCORE_MAP: { "color-badge-bg-success": 1.0, "color-badge-bg-average": 0.6, "color-badge-bg-weak": 0.1 },
        THEME_STORAGE_KEY: 'arhaTheme',
        NOTES_STORAGE_KEY: 'arhaNotes',
        DEFAULT_THEME: 'dark',
        FIXED_VERIFICATION_IMPACT: 5.0, // Fixed impact for Test Assignment verification
    },

    // ==== 2. DOM ELEMENTS ====
    dom: {},
    cacheDomElements() {
        const D = document;
        this.dom = {
            htmlElement: D.documentElement,
            themeSwitcher: D.getElementById('theme-switcher'),
            currentScoreEl: D.querySelector('[data-element="score-value"]'),
            verificationListEl: D.querySelector('[data-element="verification-list"]'),
            gradeValueDisplay: D.querySelector('[data-element="grade-value"]'),
            confidenceValueDisplay: D.querySelector('[data-element="confidence-value"]'),
            sectionSelectorBtn: D.getElementById('section-selector-btn'),
            sectionSelectorDropdown: D.getElementById('section-selector-dropdown'),
            emailBtn: D.getElementById('email-btn'),
            emailDropdown: D.getElementById('email-dropdown'),
            sendEmailBtn: D.getElementById('send-report-email'),
            emailInput: D.getElementById('recipient-email'),
            candidateNameEl: D.querySelector('[data-element="candidate-name"]'),
            scrollToTopBtn: D.getElementById('scrollToTopBtn'),
            positionTitleEl: D.querySelector('[data-element="position-title"]'),
            justificationTitle: D.querySelector('[data-element="justification-title"]'),
            assessmentValueBlock: D.querySelector('[data-block="assessment-value"]'),
            savePdfBtn: D.getElementById('save-pdf-btn'),
            saveCommentsBtn: D.getElementById('save-comments-md-btn'),
            notesTextarea: D.getElementById('notes-textarea'),
            candidateDataScript: D.getElementById('candidate-data'),
            dashboardSidebar: document.querySelector('.dashboard-sidebar'), 
            justificationSummaryBlock: document.querySelector('[data-block="justification"]'),
            finalAssessmentCard: document.querySelector('[data-section="final-assessment"]'),
        };
    },

    // ==== 3. STATE & DATA ====
    state: { profile: null },
    loadData() {
        const rawData = this.dom.candidateDataScript.textContent;
        const candidateData = JSON.parse(rawData);
        const positionText = this.dom.positionTitleEl?.querySelector('span').textContent.trim() || 'Default';
        this.state.profile = candidateData[positionText] || candidateData.Default;
    },

    // ==== 4. CORE LOGIC (CALCULATIONS) ====
    logic: {
        getScoreVerdict(score) {
            if (score < 60) return { verdict: 'Weak', class: 'color-badge-bg-weak', colorVar: 'var(--color-badge-bg-weak)' };
            if (score < 80) return { verdict: 'Average', class: 'color-badge-bg-average', colorVar: 'var(--color-badge-bg-average)' };
            return { verdict: 'Strong', class: 'color-badge-bg-strong', colorVar: 'var(--color-badge-bg-strong)' };
        },
        calculateScores(profile) {
            const { SCORE_MAP, FIXED_VERIFICATION_IMPACT } = HiringCoPilotApp.config;
            if (!profile.weights || !profile.competencies) return { currentPercentage: 0, pointsToVerify: [] };

            let totalCurrentScore = 0;
            let dynamicPoints = [];

            for (const [sectionId, sectionWeight] of Object.entries(profile.weights)) {
                const items = profile.competencies[sectionId] || [];
                let sectionScore = 0;
                items.forEach(item => {
                    const currentScore = SCORE_MAP[item.scoreClass];
                    sectionScore += currentScore * (item.weight / 100);
                    if (item.scoreClass !== 'color-badge-bg-success') {
                        const scoreChangeDecimal = SCORE_MAP['color-badge-bg-success'] - currentScore;
                        const impact = scoreChangeDecimal * (item.weight / 100) * (sectionWeight / 100) * 100;
                        dynamicPoints.push({ name: item.name, impact });
                    }
                });
                totalCurrentScore += sectionScore * (sectionWeight / 100);
            }

            let currentPercentage = totalCurrentScore * 100;
            let totalDynamicImpact = dynamicPoints.reduce((sum, p) => sum + p.impact, 0);

            if (currentPercentage + FIXED_VERIFICATION_IMPACT + totalDynamicImpact > 100) {
                const overage = (currentPercentage + FIXED_VERIFICATION_IMPACT + totalDynamicImpact) - 100;
                const scalingFactor = (totalDynamicImpact > 0) ? Math.max(0, (totalDynamicImpact - overage) / totalDynamicImpact) : 0;
                dynamicPoints.forEach(p => { p.impact *= scalingFactor; });
            }
            
            const pointsToVerify = [{ name: "Верификация через ТЗ", impact: FIXED_VERIFICATION_IMPACT, isFixed: true }, ...dynamicPoints];
            return { currentPercentage, pointsToVerify };
        },
    },

    // ==== 5. RENDER FUNCTIONS ====
    render: {
        applyTheme(theme) {
            HiringCoPilotApp.dom.htmlElement.setAttribute('data-theme', theme);
            localStorage.setItem(HiringCoPilotApp.config.THEME_STORAGE_KEY, theme);
        },
        competencyCards(profile) {
             if (!profile.weights || !profile.competencies) return;
            for (const [sectionId, items] of Object.entries(profile.competencies)) {
                const card = document.querySelector(`[data-section="${sectionId}"]`);
                if (!card) continue;
                const weightEl = card.querySelector('.category-weight');
                if (weightEl) weightEl.textContent = `(${profile.weights[sectionId]}%)`;
                const listEl = card.querySelector('.content-list');
                if (!listEl) continue;
                listEl.innerHTML = '';
                let fragment = document.createDocumentFragment();
                (items || []).forEach(item => {
                    const li = document.createElement('li');
                    li.className = `content-block ${item.scoreClass}`;
                    li.setAttribute('data-element', 'competency-item');
                    li.innerHTML = `<div class="competency-header"><span class="competency-name">${item.name}</span></div><div class="progress-display"><div class="progress-bar-wrapper"><div class="progress-bar"></div></div><span class="item-weight">${item.weight}%</span></div><p class="competency-justification" style="font-size: 0.9em; color: var(--color-text-muted);">${item.justification}</p>`;
                    fragment.appendChild(li);
                });
                listEl.appendChild(fragment);
            }
        },
        scores({ currentPercentage, pointsToVerify }, profile) {
            const { dom } = HiringCoPilotApp;
            const verdictInfo = HiringCoPilotApp.logic.getScoreVerdict(currentPercentage);

            if (dom.currentScoreEl) {
                dom.currentScoreEl.textContent = `${verdictInfo.verdict} (${currentPercentage.toFixed(1)}%)`;
                dom.currentScoreEl.className = 'score-value ' + verdictInfo.class;
            }
            
            if (dom.gradeValueDisplay && profile.grade) {
                const gradeText = profile.grade.toLowerCase();
                let gradeClass = 'color-badge-bg-average';
                if (gradeText.includes('head') || gradeText.includes('c-level')) gradeClass = 'color-badge-bg-strong';
                else if (gradeText.includes('senior') || gradeText.includes('lead')) gradeClass = 'color-badge-bg-success';
                else if (gradeText.includes('junior')) gradeClass = 'color-badge-bg-weak';
                dom.gradeValueDisplay.textContent = profile.grade;
                dom.gradeValueDisplay.className = 'score-value ' + gradeClass;
            }
            if (dom.confidenceValueDisplay && profile.confidence) {
                const confidenceText = profile.confidence.toLowerCase();
                let confidenceClass = 'color-badge-bg-average';
                if (confidenceText === 'high') confidenceClass = 'color-badge-bg-success';
                if (confidenceText === 'low') confidenceClass = 'color-badge-bg-weak';
                dom.confidenceValueDisplay.textContent = profile.confidence;
                dom.confidenceValueDisplay.className = 'score-value ' + confidenceClass;
            }

            if (dom.verificationListEl) {
                dom.verificationListEl.innerHTML = '';
                let fragment = document.createDocumentFragment();
                pointsToVerify.sort((a, b) => (b.isFixed ? 1 : 0) - (a.isFixed ? 1 : 0) || b.impact - a.impact).forEach(point => {
                    if (point.impact > 0.01) {
                        const li = document.createElement('li');
                        li.innerHTML = `<span>${point.name}</span> <span class="risk-value">+${point.impact.toFixed(1)}%</span>`;
                        fragment.appendChild(li);
                    }
                });
                dom.verificationListEl.appendChild(fragment);
            }
            
            if (dom.justificationTitle) dom.justificationTitle.style.color = verdictInfo.colorVar;
            if (dom.assessmentValueBlock) dom.assessmentValueBlock.className = `content-block assessment-value ${verdictInfo.class}`;
        },
    },
    
    // ==== 6. EVENT HANDLERS & UI HELPERS ====
    helpers: {
        toggleDropdown(btn, menu) {
            const isOpen = menu.classList.toggle('is-open');
            if (btn) btn.setAttribute('aria-expanded', isOpen);
        },
        populateSectionSelector() {
            const dom = HiringCoPilotApp.dom;
            if (!dom.sectionSelectorDropdown) return;
            const sections = Array.from(document.querySelectorAll('.dashboard-content [data-section]')).map(card => ({
                id: card.id || card.dataset.section,
                title: card.querySelector('h2 > span')?.textContent.trim() || card.id
            }));
            dom.sectionSelectorDropdown.innerHTML = '';
            sections.forEach(s => {
                const a = document.createElement('a');
                a.href = `#${s.id}`;
                a.textContent = s.title;
                a.onclick = (e) => {
                    e.preventDefault();
                    const targetElement = document.getElementById(s.id);
                    if (targetElement) targetElement.scrollIntoView({ behavior: 'smooth' });
                    HiringCoPilotApp.helpers.toggleDropdown(dom.sectionSelectorBtn, dom.sectionSelectorDropdown);
                };
                dom.sectionSelectorDropdown.appendChild(a);
            });
        },
        downloadMarkdown(content, fileName) {
            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        },
        generateEmailBody() {
            const dom = HiringCoPilotApp.dom;
            const sidebarText = dom.dashboardSidebar ? dom.dashboardSidebar.innerText : 'N/A';
            const justificationText = dom.justificationSummaryBlock ? dom.justificationSummaryBlock.innerText : 'N/A';
            const assessmentText = dom.finalAssessmentCard ? dom.finalAssessmentCard.innerText : 'N/A';
            const separator = "\n\n================================\n\n";
            return `Здравствуйте,\n\nНиже представлена краткая сводка по кандидату:\n${separator}CАММАРИ (Боковая панель):\n${sidebarText}${separator}ОБЩЕЕ ОБОСНОВАНИЕ:\n${justificationText}${separator}ФИНАЛЬНАЯ ОЦЕНКА:\n${assessmentText}\n\nПолный отчет приложен к этому письму или доступен по ссылке.\n\nС уважением,\nHiring CoPilot.`;
        },
    },
    events: {
        setupListeners() {
            const dom = HiringCoPilotApp.dom;
            const config = HiringCoPilotApp.config;
            const helpers = HiringCoPilotApp.helpers;
            const render = HiringCoPilotApp.render;

            if (dom.themeSwitcher) dom.themeSwitcher.addEventListener('click', () => render.applyTheme(dom.htmlElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'));
            if (dom.savePdfBtn) dom.savePdfBtn.addEventListener('click', () => window.print());
            if (dom.sectionSelectorBtn) dom.sectionSelectorBtn.addEventListener('click', (e) => { e.stopPropagation(); helpers.toggleDropdown(dom.sectionSelectorBtn, dom.sectionSelectorDropdown); });
            if (dom.emailBtn) dom.emailBtn.addEventListener('click', (e) => { e.stopPropagation(); helpers.toggleDropdown(dom.emailBtn, dom.emailDropdown); });
            document.addEventListener('click', (e) => {
                const isClickInside = (element, eventTarget) => element && element.contains(eventTarget);
                if (dom.sectionSelectorDropdown?.classList.contains('is-open') && !isClickInside(dom.sectionSelectorBtn.parentElement, e.target)) { helpers.toggleDropdown(dom.sectionSelectorBtn, dom.sectionSelectorDropdown); }
                if (dom.emailDropdown?.classList.contains('is-open') && !isClickInside(dom.emailBtn.parentElement, e.target)) { helpers.toggleDropdown(dom.emailBtn, dom.emailDropdown); }
            });
            if (dom.sendEmailBtn) dom.sendEmailBtn.addEventListener('click', () => {
                const recipient = dom.emailInput.value;
                if (!recipient) { alert('Введите email'); return; }
                const subject = encodeURIComponent(`Отчет по кандидату: ${dom.candidateNameEl.textContent.trim()}`);
                const body = encodeURIComponent(helpers.generateEmailBody());
                window.location.href = `mailto:${recipient}?subject=${subject}&body=${body}`;
            });
            document.querySelectorAll('#download-task-md-btn, #download-evaluation-md-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const isTask = e.currentTarget.id === 'download-task-md-btn';
                    const contentEl = document.getElementById(isTask ? 'test-assignment-md' : 'evaluation-form-md');
                    const fileName = (isTask ? 'test-assignment' : 'evaluation-criteria') + '.md';
                    let content = contentEl.textContent;
                    if (!isTask) { content = content.replace(/\|/g, ' | ').replace(/---\|/g, '---|'); }
                    helpers.downloadMarkdown(content, fileName);
                });
            });
            if (dom.saveCommentsBtn) dom.saveCommentsBtn.addEventListener('click', () => {
                const content = dom.notesTextarea.value;
                if (content) { helpers.downloadMarkdown(content, 'recruiter-comments.md'); }
            });
            if (dom.scrollToTopBtn) {
                window.addEventListener('scroll', () => { dom.scrollToTopBtn.classList.toggle('is-visible', window.scrollY > 300); });
                dom.scrollToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
            }
            if (dom.notesTextarea) {
                dom.notesTextarea.addEventListener('input', () => { localStorage.setItem(config.NOTES_STORAGE_KEY, dom.notesTextarea.value); });
            }
        },
    },

    // ==== 7. INITIALIZATION ====
    init() {
            this.cacheDomElements();
            this.render.applyTheme(localStorage.getItem(this.config.THEME_STORAGE_KEY) || this.config.DEFAULT_THEME);
            const savedNotes = localStorage.getItem(this.config.NOTES_STORAGE_KEY);
            if (this.dom.notesTextarea && savedNotes) { this.dom.notesTextarea.value = savedNotes; }

            this.loadData();
            this.helpers.populateSectionSelector();
            this.events.setupListeners();

            if (this.state.profile.grade === '[...]') {
                // Placeholder logic if needed in the future
            } else {
                this.render.competencyCards(this.state.profile);
                const scores = this.logic.calculateScores(this.state.profile);
                this.render.scores(scores, this.state.profile);
            }
    }
};

// Start the application
HiringCoPilotApp.init();
</script>
<!-- ==== END SCRIPT: MAIN APPLICATION LOGIC ==== -->

<!-- ==== END SECTION: DATA & LOGIC ==== -->
</body>
</html>
